window.passwordStrength=window.passwordStrength||{verdicts:{shortPass:"Too short",badPass:"Weak",goodPass:"Normal",strongPass:"Strong"},calculateScore:function(b,a){score=0;if(a.length<4){return this.verdicts.shortPass}if(a.toLowerCase()==b.toLowerCase()){return this.verdicts.badPass}if(a.toLowerCase().indexOf(b.toLowerCase())>=0){score-=10}if(b.toLowerCase().indexOf(a.toLowerCase())>=0){score-=10}score+=a.length*4;score+=(this.checkRepetition(1,a).length-a.length)*1;score+=(this.checkRepetition(2,a).length-a.length)*1;score+=(this.checkRepetition(3,a).length-a.length)*1;score+=(this.checkRepetition(4,a).length-a.length)*1;if(a.match(/(.*[0-9].*[0-9].*[0-9])/)){score+=5}if(a.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){score+=5}if(a.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){score+=10}if(a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)){score+=15}if(a.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&a.match(/([0-9])/)){score+=15}if(a.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&a.match(/([a-zA-Z])/)){score+=15}if(a.match(/^\w+$/)||a.match(/^\d+$/)){score-=12}if(score<0){score=0}if(score>100){score=100}if(score<34){return this.verdicts.badPass}if(score<68){return this.verdicts.goodPass}return this.verdicts.strongPass},checkRepetition:function(a,b){res="";for(i=0;i<b.length;i++){repeated=true;for(j=0;j<a&&(j+i+a)<b.length;j++){repeated=repeated&&(b.charAt(j+i)==b.charAt(j+i+a))}if(j<a){repeated=false}if(repeated){i+=a-1;repeated=false}else{res+=b.charAt(i)}}return res},randomPassword:function(a){allowed_chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz!?$?%^&*()_-+={[}]:;@~#|<,>.?/";pwd_length=a;rnd_pwd="";for(var c=0;c<pwd_length;c++){var b=Math.floor(Math.random()*allowed_chars.length);rnd_pwd+=allowed_chars.substring(b,b+1)}return rnd_pwd},init:function(d,b,c,a){passwordStrength.verdicts=jQuery.extend({},passwordStrength.verdicts,a);jQuery(d).keyup(function(){jQuery().html(passwordStrength.calculateScore(jQuery(d).val(),jQuery(b).val()))});jQuery(b).keyup(function(){jQuery(c).html(passwordStrength.calculateScore(jQuery(d).val(),jQuery(b).val()))})}};jQuery.extend(jQuery.fn,{pStrength:function(c,b,a){return this.each(function(){passwordStrength.init(c,this,b,a)})},pGenerate:function(){return this.each(function(){passwordStrength.randomPassword(8)})}});