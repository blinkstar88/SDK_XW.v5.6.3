function validateCompleteForm(b,a){return _validateInternal(b,a,0)}function validateStandard(b,a){return _validateInternal(b,a,1)}function setError(c){var f=document.getElementById("errortbl");var b=document.getElementById("errorpad");var a=document.getElementById("message");var d=document.getElementById("error");if(b&&!a){b.style.paddingTop="10px"}if(f){f.style.display="block"}if(d){d.innerHTML=c}}function setWarning(c){var f=document.getElementById("warningtbl");var b=document.getElementById("warning");var a=document.getElementById("message");var d=document.getElementById("info");if(b&&!a){b.style.paddingTop="10px"}if(f){f.style.display="block"}if(d){d.innerHTML=c}}function clearError(){var b=document.getElementById("errortbl");var a=document.getElementById("errorpad");if(b){b.style.display="none"}if(a){a.style.padding.top=0}}function clearWarning(){var b=document.getElementById("warningtbl");var a=document.getElementById("warning");if(b){b.style.display="none"}if(a){a.style.padding.top=0}}function _validateInternal(f,h,b){var e="";var d=null;if(b==0){e=(f.err)?f.err:_getLanguageText("err_form")}var a=_GenerateFormFields(f);for(var c=0;c<a.length;++c){var g=a[c];if(!g.IsValid(a)){g.SetClass(h);if(b==1){_throwError(g);return false}else{if(d==null){d=g}e=_handleError(g,e);bError=true}}else{g.ResetClass(h);clearError()}}if(d!=null){setError(e);d.element.focus();return false}return true}function _getLanguageText(a){objTextsInternal=new _jsVal_Language();if(typeof jsVal_Language!=="function"){objTexts=(typeof jsVal_Language!=="function")?null:new jsVal_Language()}switch(a){case"err_form":strResult=(!objTexts||!objTexts.err_form)?objTextsInternal.err_form:objTexts.err_form;break;case"err_enter":strResult=(!objTexts||!objTexts.err_enter)?objTextsInternal.err_enter:objTexts.err_enter;break;case"err_select":strResult=(!objTexts||!objTexts.err_select)?objTextsInternal.err_select:objTexts.err_select;break}return strResult}function _GenerateFormFields(e){var a=new Array();for(var d=0;d<e.length;++d){var c=e.elements[d];var b=_getElementIndex(a,c);if(b==-1){a[a.length]=new Field(c,e)}else{a[b].Merge(c)}}return a}function _getElementIndex(b,d){if(d.name){var a=d.name.toLowerCase();for(var c=0;c<b.length;++c){if(b[c].element.name){if(b[c].element.name.toLowerCase()==a){return c}}}}return -1}function _jsVal_Language(){this.err_form=jsval_l10n_err_form+"\n\n";this.err_select=jsval_l10n_err_select;this.err_enter=jsval_l10n_err_enter}function Field(b,c){this.type=b.type;this.element=b;this.exclude=b.exclude||b.getAttribute("exclude");this.err=b.err||b.getAttribute("err");this.required=_parseBoolean(b.req||b.getAttribute("req"));this.realname=b.realname||b.getAttribute("realname");this.elements=new Array();switch(this.type){case"textarea":case"password":case"text":case"file":this.value=b.value;this.minLength=b.minlength||b.getAttribute("minlength");this.maxLength=b.maxlength||b.getAttribute("maxlength");this.regexp=this._getRegEx(b);this.minValue=b.minvalue||b.getAttribute("minvalue");this.maxValue=b.maxvalue||b.getAttribute("maxvalue");this.equals=b.equals||b.getAttribute("equals");this.callback=b.callback||b.getAttribute("callback");break;case"select-one":case"select-multiple":this.values=new Array();for(var a=0;a<b.options.length;++a){if(b.options[a].selected&&((typeof this.exclude=="undefined")||b.options[a].value!=this.exclude)){this.values[this.values.length]=b.options[a].value}}this.callback=b.callback||b.getAttribute("callback");this.min=b.min||b.getAttribute("min");this.max=b.max||b.getAttribute("max");this.equals=b.equals||b.getAttribute("equals");break;case"checkbox":this.min=b.min||b.getAttribute("min");this.max=b.max||b.getAttribute("max");case"radio":this.required=_parseBoolean(this.req||b.getAttribute("req"));this.values=new Array();if(b.checked){this.values[0]=b.value}this.elements[0]=b;break}}Field.prototype.Merge=function(a){var b=_parseBoolean(a.getAttribute("req"));if(b){this.required=true}if(!this.err){this.err=a.getAttribute("err")}if(!this.equals){this.equals=a.getAttribute("equals")}if(!this.callback){this.callback=a.getAttribute("callback")}if(!this.realname){this.realname=a.getAttribute("realname")}if(!this.max){this.max=a.getAttribute("max")}if(!this.min){this.min=a.getAttribute("min")}if(!this.regexp){this.regexp=this._getRegEx(a)}if(a.checked){this.values[this.values.length]=a.value}this.elements[this.elements.length]=a};Field.prototype.IsValid=function(a){if(this.element.disabled){return true}switch(this.type){case"textarea":case"password":case"text":case"file":return this._ValidateText(a);case"select-one":case"select-multiple":case"radio":case"checkbox":return this._ValidateGroup(a);default:return true}};Field.prototype.addClassName=function(d,e){var b=d.className.split(" ");var a;for(a=0;a<b.length;a++){if(b[a]==e){return}}b.push(e);d.oldClassName=d.className;d.className=b.join(" ")};Field.prototype.SetClass=function(a){if((a)&&(a!="")){if((this.elements)&&(this.elements.length>0)){for(var b=0;b<this.elements.length;++b){this.addClassName(this.elements[b],a)}}else{this.addClassName(this.element,a)}}};Field.prototype.ResetClass=function(b){if((this.type!="button")&&(this.type!="submit")&&(this.type!="reset")){if((this.elements)&&(this.elements.length>0)){for(var a=0;a<this.elements.length;++a){if(this.elements[a].oldClassName){this.elements[a].className=this.elements[a].oldClassName}else{if(this.elements[a].className==b){this.elements[a].className=""}}}}else{if(this.element.oldClassName){this.element.className=this.element.oldClassName}else{if(this.element.className==b){this.element.className=""}}}}};Field.prototype._getRegEx=function(a){regex=a.regexp||a.getAttribute("regexp");if(regex==null){return null}retype=typeof(regex);if(retype.toUpperCase()=="FUNCTION"){return regex}else{if((retype.toUpperCase()=="STRING")&&!(regex=="JSVAL_RX_EMAIL")&&!(regex=="JSVAL_RX_TEL")&&!(regex=="JSVAL_RX_PC")&&!(regex=="JSVAL_RX_ZIP")&&!(regex=="JSVAL_RX_MONEY")&&!(regex=="JSVAL_RX_CREDITCARD")&&!(regex=="JSVAL_RX_POSTALZIP")&&!(regex=="JSVAL_RX_IPADDRESS")&&!(regex=="JSVAL_RX_NETMASK")&&!(regex=="JSVAL_RX_MACADDR")){nBegin=0;nEnd=regex.length;if(regex.charAt(0)=="/"){nBegin=1}if(regex.charAt(regex.length-1)=="/"){nEnd=regex.length-1}return new RegExp(regex.slice(nBegin,nEnd))}else{return regex}}};Field.prototype._ValidateText=function(arrFields){if((this.required)&&(this.callback)){nCurId=this.element.id?this.element.id:"";nCurName=this.element.name?this.element.name:"";eval("bResult = "+this.callback+"('"+nCurId+"', '"+nCurName+"', '"+this.value.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"');");if(bResult==false){return false}}else{if(this.required&&!this.value){return false}if(this.value&&(this.minLength&&this.value.length<this.minLength)){return false}if(this.value&&(this.maxLength&&this.value.length>this.maxLength)){return false}if(this.regexp){if(!_checkRegExp(this.regexp,this.value)){if(this.required){return false}}else{return true}}if(this.equals){for(var i=0;i<arrFields.length;++i){var field=arrFields[i];if((field.element.name==this.equals)||(field.element.id==this.equals)){if(field.element.value!=this.value){return false}break}}}if(this.required){if((this.minValue||this.maxValue)&&!(/^\s*[+-]?\d+\s*$/).test(this.value)){return false}var fValue=parseFloat(this.value);if((this.minValue||this.maxValue)&&isNaN(fValue)){return false}if((this.minValue)&&(fValue<this.minValue)){return false}if((this.maxValue)&&(fValue>this.maxValue)){return false}}}return true};Field.prototype._ValidateGroup=function(arrFields){if((this.required)&&(this.callback)){nCurId=this.element.id?this.element.id:"";nCurName=this.element.name?this.element.name:"";eval("bResult = "+this.callback+"('"+nCurId+"', '"+nCurName+"', '"+this.element.options[this.element.selectedIndex].value.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"');");if(bResult==false){return false}}if(this.required&&this.values.length==0){return false}if(this.required&&this.min&&this.min>this.values.length){return false}if(this.required&&this.max&&this.max<this.values.length){return false}return true};function _handleError(c,a){var b=c.element;strNewMessage=a+((c.realname)?c.realname:((b.id)?b.id:b.name))+"\n";return strNewMessage}function _throwError(b){var a=b.element;switch(b.type){case"text":case"password":case"textarea":case"file":setError(_getError(b,"err_enter"));try{a.focus()}catch(c){}break;case"select-one":case"select-multiple":case"radio":case"checkbox":setError(_getError(b,"err_select"));break}}function _getError(b,c){var a=b.element;strErrorTemp=(b.err)?b.err:_getLanguageText(c);idx=strErrorTemp.indexOf("\\n");while(idx>-1){strErrorTemp=strErrorTemp.replace("\\n","\n");idx=strErrorTemp.indexOf("\\n")}return strErrorTemp.replace("%FIELDNAME%",(b.realname)?b.realname:((a.id)?a.id:a.name))}function _parseBoolean(a){return !(!a||a==0||a=="0"||a=="false")}function _checkRegExp(d,c){switch(d){case"JSVAL_RX_EMAIL":return((/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,5})+$/).test(c));case"JSVAL_RX_TEL":return((/^1?[\-]?\(?\d{3}\)?[\-]?\d{3}[\-]?\d{4}$/).test(c));case"JSVAL_RX_PC":return((/^[a-z]\d[a-z]?\d[a-z]\d$/i).test(c));case"JSVAL_RX_ZIP":return((/^\d{5}$/).test(c));case"JSVAL_RX_MONEY":return((/^\d+([\.]\d\d)?$/).test(c));case"JSVAL_RX_CREDITCARD":return(!isNaN(c));case"JSVAL_RX_POSTALZIP":if(c.length==6||c.length==7){return((/^[a-zA-Z]\d[a-zA-Z] ?\d[a-zA-Z]\d$/).test(c))}if(c.length==5||c.length==10){return((/^\d{5}(\-\d{4})?$/).test(c))}break;case"JSVAL_RX_IPADDRESS":return((/^([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\.([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3}$/).test(c));break;case"JSVAL_RX_NETMASK":if(!_checkRegExp("JSVAL_RX_IPADDRESS",c)){return false}var a=c.split(".");var b=parseInt(a[0])*16777216+65536*parseInt(a[1])+256*parseInt(a[2])+parseInt(a[3]);b=256*256*256*256-b-1;return(b&(b+1))==0;break;case"JSVAL_RX_MACADDR":return((/^([0-9a-f]{2}(:|$)){6}$/).test(c));break;default:return(d.test(c))}};