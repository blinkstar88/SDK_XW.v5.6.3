function ack2meters(b,a){if(b<a){return 0}return(b-a)*150}function AckController(c,b,a){this.ack=c;this.dst=b;this.slider=a;this.maximum=0;c.controller=this;b.controller=this;a[0].controller=this;this.setMaximum=function(d){this.maximum=d};this.updated=function(d,e){if(e<0){e=0}else{if(e>this.maximum){e=this.maximum}}if(d.id!=this.slider[0].id){this.slider.slider("option","value",e)}this.dst.setValue(Math.round(e));this.ack.setValue(e)}}function createSlider(d,c){var f=1.609344;var e=$("#slider-ui-1");var h=$("#acktimeout")[0];var g=$("#distance")[0];var a=new AckController(h,g,e);var b=ack2meters(c,d)/100/f;a.setMaximum(b);e.slider({range:"min",value:40,min:0,max:Math.round(b),step:1,animate:"slow",slide:function(k,l){this.controller.updated(this,parseInt(l.value))}});e.addClass("ui-widget-content-slider");g.slider=e;g.onchange=function(){var k=parseFloat(this.value);var l;if(isNaN(k)){k=0}l=Math.floor(k*10);this.controller.updated(this,l)};g.distkm=$("#distkm")[0];g.setValue=function(k){this.value=k/10;if(this.distkm){this.distkm.innerHTML=Math.round(k*f)/10}};h.slider=e;h.distance=$("#ackdistance")[0];h.setValue=function(l){var k=Math.round(l*100*f);this.value=Math.round(k/150)+d;if(this.distance){this.distance.value=Math.round(k/150)*150}};h.onchange=function(){var k=parseInt(this.value);var l;if(isNaN(k)){k=d}l=ack2meters(k,d)/100/f;this.controller.updated(this,l)};h.onchange()}function createQDurSlider(){if(!document.getElementById("slider-2")){return}var a=new Slider(document.getElementById("slider-2"),document.getElementById("slider-input-2"));a.setMinimum(5);a.setMaximum(100);a.setMaxMarker(100);a.onchange=function(){$("#qdur").val(this.getValue())};a.setValue($("#qdur").val())}function createTxPowerSlider(){var a=$("#txpower");var b=$("#slider-ui-2");b.slider({range:"min",value:40,min:-40,max:40,step:1,animate:"slow",slide:function(c,d){a.val(d.value)}});b.addClass("ui-widget-content-slider");a[0].onchange=function(){var c=parseInt(a.val());if(isNaN(c)){c=0}b.slider("option","value",c)};a[0].onchange()}function disableSlider(b){var a=$("#"+b);if(!a){return false}a.slider("option","value",a.slider("option","min"));a.slider("disable")}function setESSID(f,c,b){var h=$("#essid");var a=$("#apmac");if(f.essid.length>0){h.val(_uesc(f.essid));a.val(!b?"":f.mac)}else{h.val("any");a.val(f.mac)}var d=f.encryption.toLowerCase();if(d=="-"){d="none"}if(d=="wpa"||d=="wpa2"){if(f.pairwise_ciphers.indexOf("CCMP")>=0){d+="aes"}else{if(f.pairwise_ciphers.indexOf("TKIP")>=0){d+="tkip"}}}$("#security").val(d);$("#security").change();var e="WPA-PSK";if(f.auth_suites.toLowerCase().indexOf("802.1x")>=0){e="WPA-EAP"}$("#wpa_auth").val(e);$("#wpa_auth").change();if(f.htcap==0){$("#rate_auto").attr("checked",true);$("#rate option:eq(0)").attr("selected","selected")}var g=$("#chanbw_select").val();if(g!=c){$("#chanbw_select").val(c=="0"?"20":c);$("#chanbw_select").change()}}function ieee_mode_fixer(b,a){this.ieee_mode=b.toLowerCase();if(a==""){a="20"}this.chanbw=a;this.getIEEEMode=function(){if(this.ieee_mode.length>6){return this.ieee_mode.substr(0,6)}return this.ieee_mode};this.getChanBW=function(){if(this.ieee_mode.length>=8&&this.ieee_mode.substr(6,2)=="40"){return"40"}return this.chanbw};this.getExtChannel=function(){var c=null;if(this.ieee_mode.length>=8&&this.ieee_mode.substr(6,2)=="40"){c=this.ieee_mode.substr(8);if(c!="minus"&&c!="plus"){c=""}}return c}}var rates_cck=[1,2,5.5,11];var rates_ofdm=[6,9,12,18,24,36,48,54];var rates_ht20=[6.5,13,19.5,26,39,52,58.5,65];var rates_ht40=[15,30,45,60,90,120,135,150];function hasCCK(a){return(a=="b"||a=="g"||a=="pureg")}function hasOFDM(a){return(a=="a"||a=="g"||a=="pureg")}function hasHT(a){return(a=="11naht"||a=="11nght")}function compareNum(d,c){return d-c}function init_rates(b,l,k,p,s,a){var n=document.getElementById(s);if(!n){return p}var v=[];var h;var t,r;if(!b||b[getRegdomainMode(l)]){if(globals.chanbw==0){globals.chanbw=20}if(hasCCK(l)&&globals.chanbw==20){v=v.concat(rates_cck)}if(hasOFDM(l)){v=v.concat(rates_ofdm)}if(hasHT(l)){for(t=1;t<=radio_chains;t++){h=v.length;v=(40==k)?v.concat(rates_ht40):v.concat(rates_ht20);for(r=h;r<v.length;r++){v[r]=v[r]*t}}}else{v.sort(compareNum)}}var c=n.options;c.length=0;var u=v.length;var w=$("#wmode").val();is_ap=(w=="ap"||w=="aprepeater");for(t=u-1;t>=0;t--){var m=hasHT(l)?t:v[t];var e=v[t];var d=0;var q="MCS "+t+" - ";if((40==k)&&!is_ap){var g=t%8;var f=Math.floor(t/8)+1;e=rates_ht20[g]*f;d=rates_ht40[g]*f}e*=(globals.chanbw/(40==k?40:20));d*=(globals.chanbw/(40==k?40:20));if(40==k&&is_ap){q+=(Math.round(10*e*0.9)/10)+"/"+(Math.round(10*e)/10)}else{q+=(Math.round(10*e)/10)+"/"+(Math.round(10*e/0.9)/10)}if(d){if(40==k&&!is_ap){q+=(" ["+(Math.round(10*d*0.9)/10)+"/"+(Math.round(10*d)/10)+"]")}else{q+=(" ["+(Math.round(10*d)/10)+"/"+(Math.round(10*d/0.9)/10)+"]")}}c[c.length]=new Option(q,m,false,p==m)}if(a){n.selectedIndex=0}$(document).trigger("rate_list_updated");return c.length?n.options[n.selectedIndex].value:p}function setWepEnabled(a,b){$("#wep_key_length, #wep_key_id, #wep_key, #wep_key_type").enable(a);if(b&&a){$("#wep_key").focus()}}function setWpaEnabled(b,e){var c=$("#wpa_key");var d=$("#wpa_auth");var a=d.val();c.disable(!b);d.disable(!b);var f=(a&&a.toUpperCase()=="WPA-PSK");if(f){$(".i_wpaeap").disable();$(".i_wpapsk").disable(!b);$(".wpaeap").hide();$(".wpapsk").toggle(b)}else{$(".i_wpapsk").disable();$(".i_wpaeap").disable(!b);$(".wpapsk").hide();$(".wpaeap").toggle(b);toggleRadiusAcct()}if(e&&b){if(f){c.focus()}else{$(".wpaeap .pwd").focus()}}}function setNoSecEnabled(b,c){var a=$("#radius_mac_acl_status").is(":checked");if(b){$(".radmacacl").toggle(a);$(".i_radaclmac").disable(!a);$(".i_radaclmacform").disable(!a);$(".radaclmacform").toggle(a);toggleRadiusAcct()}else{$(".nosec").toggle(b);$(".i_radaclmacform").disable(!b);$(".radaclmacform").toggle(b)}}function setAuthTypeEnabled(a){$('[name="authtype"]').enable(a)}function setMACClone(a){var b=$("#macclone").enable(a);if(!a){b.attr("checked",false)}}function setAutoWDS(a){var b=$("#wds_auto").enable(a);if(!a){b.attr("checked",false)}}function setWDSPeers(b){var a=$("[name^=peer]").enable(b);if(!b){a.val("")}}function chooseSecurity(h,e){var f=h.value.toUpperCase();var c=document.getElementById("wmode");var g=false;var k=false;var a=false;var d=false;var l=true;var b=true;if(c!=null){c=c.value.toLowerCase()}if(f=="WEP"){g=false;k=true;d=true;updateWepError()}else{if(f.substring(0,3)=="WPA"){g=true;k=false;d=false;l=false;if(c=="aprepeater"){b=false}}else{a=true}}$(".nosec").toggle(a);$(".wpa").toggle(g);$(".wep").toggle(k);setWpaEnabled(g,e);setWepEnabled(k,e);setNoSecEnabled(a,e);setAuthTypeEnabled(d);setMACClone(l);setAutoWDS(b);setWDSPeers(b)}function chooseWPA(a,d){var c=$("#security").val().toUpperCase();var b=(c.substring(0,3)=="WPA");if(c=="NONE"){setNoSecEnabled(true,d)}else{setWpaEnabled(b,d)}}function chooseDiversity(a,f,e){var d=document.getElementById(f);var c=document.getElementById(e);var b=false;if(a.checked){b=true}d.disabled=b;c.disabled=b}var RADSecret_regex=/^[\x20-\x7e]*$/;function validateRadiusSecret(c,a,b){if(b!=null&&b.length>0&&b.length<33&&RADSecret_regex.exec(b)!=null){return true}return false}var HwAddr_regex=/^([0-9a-fA-F][0-9a-fA-F]:){5}([0-9a-fA-F][0-9a-fA-F])$/;function validateHwAddr(c,a,b){if(c=="peer1"){if(!$("#wds_auto").is(":checked")&&!b){return false}}if(b!=null&&b.length>0&&HwAddr_regex.exec(b)==null){return false}return true}var WEP64_regex=/^([0-9]|[a-f]|[A-F]){10}$/;var WEP128_regex=/^([0-9]|[a-f]|[A-F]){26}$/;function updateWepError(){var b=document.getElementById("wep_key");var c=document.getElementById("wep_key_length");var e=document.getElementById("wep_key_type");var a=5;if(c.value=="wep128"){a=13}var d="HEX pairs";if(e&&e.value=="2"){d="ASCII characters"}b.realname="WEP key ("+a+" "+d+")"}function validateWepKey(c,b,h){var g=document.getElementById("security");if(g.value.toUpperCase()=="WEP"){var k=document.getElementById(c);var a=document.getElementById("wep_key_length");var d=document.getElementById("wep_key_type");var e=10;var f=WEP64_regex;if(a.value=="wep128"){e=26;f=WEP128_regex}if(d&&d.value=="2"){f=null;if(e==10){e=5}else{e=13}}if(h==""||h.length!=e){return false}if(f!=null&&f.exec(h)==null){return false}}return true}function validateWpaKey(f,a,c){var e=document.getElementById("security");var d=e.value.toUpperCase();var b=document.getElementById("wpa_auth");if(b){b=b.value.toUpperCase()}if(d.substring(0,3)=="WPA"&&(b!="WPA-EAP")){if(c==""||c.length<8||c.length>63){return false}if(!/^[ -~]{8,63}$/.test(c)){return false}}return true}function validateWpaIdent(d,a,c){security=$("#security").val().toUpperCase();var b=$("#wpa_auth").val().toUpperCase();if(security.substring(0,3)=="WPA"&&b=="WPA-EAP"){if(c==""||c.length<1||c.length>63){return false}if(!/^[ -~]{1,63}$/.test(c)){return false}}return true}function validateSecurity(e,a,b){var d=$("#security").val().toUpperCase();var c=$("#wmode").val().toUpperCase();if((c!="APREPEATER"&&d.search("AES")==-1&&d.substring(0,4)!="NONE")||(c=="APREPEATER"&&d.search("WEP")==-1&&d.substring(0,4)!="NONE")){return false}return true}function shaperStatusClicked(){var a=$("#shaper_status").is(":checked");$(".i_shaper").disable(!a);$(".shaper").toggle(a)}function obeyRegulatoryStatusClicked(){if(globals.ant_builtin==1){$("#cable_loss").prop("disabled",true)}}function getRegdomainMode(a){if(a=="a"||a=="11naht"){return"A"}if(a=="b"){return"B"}return"G"}function checkUbntExtChanFlags(c,b){var a=!parseInt(c);if(a&&!(b[2]&1)){return false}return true}function parse_full_regdomain(d){var f;var p;var g;var a;var m;var k;var e=[];var c=0;var n;var l=false;for(f=1;f<d.length-1;f++){p=d[f].split(/\s+/);g=p[2];a=parseInt(p[0]);k=a;m=p[3];if(!e[g]){e[g]=[]}if(!e[g][m]){e[g][m]=[]}c=parseInt(p[5]);if(isNaN(c)){c=0}dfs_chan=((c&9)==9);l=l||dfs_chan;if(parseInt(p[6])){n=2}else{n=1}var b=parseInt(p[7]);if(isNaN(b)){b=1}if(!e[g][m][k]){e[g][m][k]=[p[0],parseFloat(p[4]),n,c,b,dfs_chan]}else{e[g][m][k][2]|=n}}var h={regdomain:e,has_dfs:l};return h}function selectToArray(b){var a=[];var c=0;b.find("option").each(function(){a[c]=[];a[c].value=$(this).val();a[c].display=$(this).text();a[c++].selected=($(this).selected==true)});return a}function arrayToSelect(a,b,e){var c="";for(var d=0;d<b.length;++d){if(e&&!e(d)){continue}c+='<option value="'+b[d].value+(b[d].selected?' selected">':'">')+b[d].display+"</option>"}a.html(c)}function filterRates(d){var a=$("#rate");MIN_WEP_INDEX=3;if(typeof filterRates.all=="undefined"){filterRates.all=selectToArray(a)}var b=selectToArray(a);var c=a.prop("selectedIndex");if(/^(wep|wpa|wpatkip|wpa2|wpa2tkip)$/.test(d)){if(filterRates.all.length==b.length){arrayToSelect(a,filterRates.all,function(f){return(f>=MIN_WEP_INDEX)});c=(c<=MIN_WEP_INDEX)?0:c-MIN_WEP_INDEX;$("#rate option:eq("+c+")").attr("selected","selected")}}else{if(filterRates.all.length>b.length){arrayToSelect(a,filterRates.all);var e=$("#rate_auto").is(":checked");if(!e||e&&c>0){c+=MIN_WEP_INDEX}$("#rate option:eq("+c+")").attr("selected","selected")}}}function get_scan_channels(c,b,g,a,k,h){var d;var m=[];var f=getRegdomainMode(b);if(!c[f]||!c[f][g]){return m}var e=c[f][g];if(40==g&&c[f][20]&&!h){var l=c[f]["20"];o:for(d in l){for(j in e){if(e[j][0]==l[d][0]){continue o}}e.push(l[d])}}for(d in e){if(!checkUbntExtChanFlags(a,e[d])){continue}if(k&&e[d][4]==0){continue}m.push(e[d][0])}m.sort(compareNum);return m}function init_sta_power(c){var f;var a;var d;var e=[];var b;for(f in c){e[f]=[];for(a in c[f]){for(d in c[f][a]){b=c[f][a][d][1];if(isNaN(b)){continue}if(!e[f][a]){e[f][a]=[b]}else{if(e[f][a][0]<b){e[f][a][0]=b}}}}}return e}function ChannelWidth(c){var b={"40":{label:globals.i18n.ht40_label}};function d(e){if(b[e]&&b[e].label){return b[e].label}else{return""+e+" MHz"}}function a(e){return e}this.width=c;this.label=d(c);this.cfg=a(c)}function getChannelWidths(c){var a=c.split(",");var d=[];for(var b=0;b<a.length;b++){d.push(new ChannelWidth(a[b]))}d.sort();d.reverse();return d}function init_chanbw(c,b,g){var d=getRegdomainMode(b);if(!c[d]){return g}var h=document.getElementById("chanbw_select");if(!h){return g}var k=h.options;k.length=0;var a=g;var f=getChannelWidths(globals.supported_chanbw);var e=false;$.each(f,function(l,p){if(c[d][p.width]){var n=(p.width==a);if(n){e=true}var m=new Option(p.label,p.width,false,n);k[k.length]=m;$.data(m,"chanbw",p.cfg)}});globals.chanbw=e?g:parseInt(h.options[0].value);return k.length?h.options[h.selectedIndex].value:value}function init_frequencies(d,l,h,k,q,c,e){var t=$("#chan_freq");var m=getRegdomainMode(l);if(!d[m]||!d[m][h]){return q}var f=[];var b=d[m][h];var p=$("#obey_regulatory_checkbox").is(":checked");for(var s in b){if(!checkUbntExtChanFlags(k,b[s])||(p&&b[s][4]==0)){continue}var u={};u.freq=b[s][0];u.dfs=b[s][5];f.push(u)}f.sort(function(x,w){return x.freq-w.freq});var n=[];n.push('<option value="0">'+jsTranslate("auto")+"</option>");var r=false;if(requiresCE(country)||country==756){r=true}$.each(f,function(w,B){if((r&&e&&isFreqIndoor(B.freq))){}else{var y='<option value="'+B.freq+'"';if(country=="902"){switch(B.freq){case"905":B.freq="904.75";break;case"918":B.freq="918.25";break;case"925":B.freq="924.75";break;case"922":B.freq="921.75";break}}if(!B.dfs){y+=(r&&isFreqIndoor(B.freq)?' class="indoor"':"")+">"+B.freq+(r&&isFreqIndoor(B.freq)?" (Indoor)":"")+"</option>"}else{var A="";var x="";var z=$("#wmode").val();if(board_fcc_unii_enabled=="true"&&z=="aprepeater"){A=' disabled="disabled"';x=" unii"}y+=' class="'+x+(r&&isFreqIndoor(B.freq)?" indoor":"")+'"';y+=A+">"+B.freq+" (DFS"+(r&&isFreqIndoor(B.freq)?" + Indoor":"")+")</option>"}n.push(y)}});var a=t.val();t.empty().append(n.join(""));if(!c){t.val(q);if(t.val()!=q){t.val(0)}}else{t.val(a);if(t.val()!=a){var g=0;for(var s=f.length-1;s>=0&&g==0;s--){if(f[s]<=a){g=f[s];found=true}}t.val(g)}}var v=t.val();$(document).trigger("frequencies_updated");return v}function get_channel_by_freq(a,c){if(!a||!c){return null}var b;for(b in a){if(a[b][0]==c){return b}}return null}function setMaxrate(d,b){var a=document.getElementById(d);var c=document.getElementById("maxrate");if(!a||!a.length){return false}if(c){c.innerHTML=a.options[a.length-1].text}}function getRegdomainPower(c,h,b,k,d){var f=getRegdomainMode(b);var a=txpower_max;var g=null;var e;if(country=="511"||country=="124"||((country=="840"||country=="630")&&is_A(b))){if((country!="511"&&is_A(b)&&d<5730)||((country=="840"||country=="630")&&board_fcc_unii_enabled)){}else{obey=false;return 100}}e=c[f][k];g=get_channel_by_freq(e,d);if(g==null){if(h[f]&&h[f][k]){a=h[f][k][0]}}else{if(c[f]&&c[f][k]&&c[f][k][g]){a=c[f][k][g][1]}}return a}function toggleObeyRegulatory(){reinit_form(3);calcChanlistMinPower();updateSliderPosition();$(document).trigger("obey_toggled")}function updateSliderPosition(){var a=$("#txpower")[0];var b=$("#slider-ui-2");if(!a){return false}a.minvalue=calc_min_txpower();a.maxvalue=calc_max_txpower();if(a.minvalue>a.maxvalue){a.maxvalue=a.minvalue}if(a.value>a.maxvalue){a.value=a.maxvalue}else{if(a.value<a.minvalue){a.value=a.minvalue}}b.slider("option","min",a.minvalue);b.slider("option","max",a.maxvalue);b.slider("option","value",a.value);$("#txpower").val(a.value)}function calcChanlistMinPower(){var f=parseInt($("#chan_freq").val());var g=$("#wmode").val().toUpperCase();var c=parseInt($("#txpower").val());var e=$("#obey_regulatory_checkbox").is(":checked");var a=$("#channel_scan_list").is(":checked");if((g=="STA"||!f||polling_fh)&&e){if(a){var h=$("#scan_channels").val().split(",");if(!h[0]){return}txpower_regdomain_limit=checkScanListPower("max",h,regdomain,chanbw)}else{var d=$("#ieee_mode").val().toLowerCase();var b=get_scan_channels(regdomain,d,globals.chanbw,airmax,obey,is_ap);if(!b[0]){return}txpower_regdomain_limit=checkScanListPower("max",b,regdomain,chanbw)}}}function updateSliderOnChanlist(){if($("#polling_airselect").is(":checked")){return}calcChanlistMinPower();updateSliderPosition()}function init_power(b,d,c,a,e){txpower_regdomain_limit=getRegdomainPower(b,d,c,a,e);toggleObeyRegulatory()}function onIEEEMode(a){ieee_mode=a.options[a.selectedIndex].value;reinit_form(1)}function onChanbwsel(a){var b=a.options[a.selectedIndex];chanbw=b.value;globals.chanbw=$.data(b,"chanbw");$("#chanbw").val(chanbw);submitNoSave()}function onFrequency(a){chan_freq=a.options[a.selectedIndex].value;reinit_form(4)}function onExtChannel(a){extchannel=a.options[a.selectedIndex].value;document.getElementById("extchannel").value=extchannel;reinit_form(5)}function onSecurity(a,c){chooseSecurity(a,c);if(parseInt(radio_chains)==1){return}var b=$("#rate").val();filterRates(a.value);var d=$("#rate").val();if(b!=d){rate=d;reinit_form(2,true)}}function adjustMulticastRate(d,b){var c;var f;var a=document.getElementById(b);var e=document.getElementById("mcast_rate");if(!e||!a||!a.length){return d}f=""+d;d=a.options[0].value;for(c=0;c<a.length;c++){if(f==a.options[c].value){d=f}}e.value=d;return d}function on_antenna_gain_change(a){antenna_info=$("#antenna_info").val();if(String(antenna_info).indexOf("|")>=0){_gain=parseInt(antenna_info.split("|")[1])}else{_gain=parseInt(antenna_info)}if(isFinite(_gain)){antenna_gain=_gain.valueOf();if(document.getElementById("antenna_info").type=="text"){if(antenna_gain>40){$("#antenna_info").val(40);antenna_info="0|40"}if(antenna_gain<0){$("#antenna_info").val(0);antenna_info="0|0"}}toggleObeyRegulatory()}else{$("#antenna_info").val(0)}}function on_cable_loss_change(a){_loss=new Number($("#cable_loss").val());if(isFinite(_loss)){cable_loss=_loss.valueOf();if(cable_loss>40){$("#cable_loss").val(40);cable_loss=40}if(cable_loss<0){$("#cable_loss").val(0);cable_loss=0}toggleObeyRegulatory()}else{$("#cable_loss").val(0)}}function requiresCE(b){var a=[40,56,100,191,196,203,208,233,246,250,276,300,348,352,372,380,428,438,440,442,470,528,530,578,616,620,642,703,705,724,752,826];return($.inArray(parseInt(b),a)!=-1)}function requiresFCC(b){var a=[84,124,188,214,222,320,340,388,484,530,591,630,780,840,];return($.inArray(parseInt(b),a)!=-1)}function is_G(a){return a.toUpperCase().indexOf("G")>=0}function is_A(a){return !is_G(a)}function calc_max_txpower(){if(!$("#obey_regulatory_checkbox").is(":checked")||country=="511"){return txpower_max}if(String(antenna_info).indexOf("|")>=0){antenna_gain=parseInt(antenna_info.split("|")[1])}else{antenna_gain=parseInt(antenna_info)}var a=txpower_regdomain_limit-antenna_gain+cable_loss;var b=$("#ieee_mode").val();if(requiresFCC(country)){if(country!="124"&&is_G(b)&&antenna_gain>=6){a=32+cable_loss-Math.ceil(antenna_gain/3)}}if(a>txpower_max){a=txpower_max}return a}function calc_min_txpower(){return radio_txpower_min}function calc_max_gain(){var c=calc_min_txpower();var b=txpower_regdomain_limit-c+cable_loss;var a=$("#ieee_mode").val();if(requiresFCC(country)){if(is_G(a)&&b>=6){b=96-c*3+cable_loss}if(is_A(a)&&b>23){b=53-c+cable_loss}}return b}function calc_min_loss(){var a=$("#antenna_info");if(String(a).indexOf("|")>=0){var d=parseInt(a.val().split("|")[1])}else{var d=parseInt(a.val())}var c=$("#ieee_mode").val();var e=calc_min_txpower();var b=d+e-txpower_regdomain_limit;if(requiresFCC(country)){if(is_G(c)&&d>=6){b=d-96+e*3}if(is_A(c)&&d>23){b=d-53+e}}return b}function toggleMACACL(){var a=$("#mac_acl_status").is(":checked");$(".i_macacl").disable(!a);$(".macacl").toggle(a)}function toggleRadiusMACACL(){setNoSecEnabled(true,false)}function toggleRadiusAcct(){var c=$("#security").val().toUpperCase().substring(0,3);var a=$("#radius_acct_status").is(":checked");var d=$("#radius_mac_acl_status").is(":checked");var b=((a&&(c=="WPA"))||(a&&d&&(c=="NON")));$(".radacct").toggle(b);$(".i_radacct").disable(!b)}function doStaSubmit(a){if($("#cc",a).is(":disabled")){if(!validateStandard(a,"error")){return false}}return true}function doAPSubmit(a){mac_error_set=0;if($("#cc",a).is(":disabled")){if(!validateStandard(a,"error")){return false}if(!validateFrequency()||!validateFreqListStatus()){return false}}return true}function submitNoSave(){var a=["wpa_auth","wpa_eap","wep_key_length","wep_key_type","wep_key_id"];var b=$("#this_form");$.each(a,function(c,d){if($("#"+this).is(":disabled")){b.append('<input type="hidden" name="'+this+'" value="'+$("#"+this).val()+'"/>')}});$("#cc").enable();b.submit()}function onChangeAPSubmit(){submitNoSave()}function onStaChangeSubmit(){submitNoSave()}function onAntennaChange(a){if($("#rate option:selected").index()==0){$("#this_form").append('<input type="hidden" name="select_max_rate" value="1"/>')}return a?onChangeAPSubmit():onStaChangeSubmit()}function validateChannels(a,c){if(c.length==0){return false}for(var b=0;b<c.length;++b){if($.inArray(c[b],a)==-1){return false}}return true}function validateChannelScanList(e,c,d){if(!$("#channel_scan_list").is(":checked")){return true}var a=get_current_scan_channels(d);var b=get_scan_channels(regdomain,ieee_mode,globals.chanbw,airmax,obey,is_ap);return validateChannels(b,a)}function toggleScanChannels(){var a=$("#channel_scan_list").is(":checked");$("#scan_channels").toggle(a);$("#edit_scan_channels").toggle(a)}function toggleDfs(){var a=rg_data.has_dfs&&!requiresCE(country)&&country!=756&&country!=840&&country!=124&&country!=630&&country!=764;$("#dfs_row").toggle(a)}function toggleCcChange(){var a=is_changeable_country(country);$("#change_ccode").toggle(a)}function validateDfsChansWrls(){var g=$("#wmode").val();if((g=="sta")||(devdomain!="5000")){return}var f=getDfsStatus();if(polling_fh&&polling&&f){var e=$("#chan_freq").val();if(e!=0){if(isFreqDfs(regdomain,ieee_mode,chanbw,e)){document.getElementById("chan_freq").selectedIndex=0}}var c=document.getElementById("chan_freq");for(d=1;d<c.length;d++){if(isFreqDfs(regdomain,ieee_mode,chanbw,c.options[d].value)){c.options[d].disabled=true}}if($("#channel_scan_list").is(":checked")){var b=get_current_scan_channels($("#scan_channels").val());var a=[];for(var d=0;d<b.length;d++){if(!isFreqDfs(regdomain,ieee_mode,chanbw,b[d])){a.push(b[d])}}$("#scan_channels").val(a)}}else{var c=document.getElementById("chan_freq");for(d=1;d<c.length;d++){if(c.options[d].disabled){c.options[d].disabled=false}}$(".unii").attr("disabled","disabled")}}function validateDfsChansUbnt(e,f,c){if(f||(c!="5000")){return}if(e=="true"){if($("#polling_airselect").is(":checked")&&$("#polling").is(":checked")){var b=get_current_scan_channels($("#polling_airselect_channels").val());var a=[];for(var d=0;d<b.length;d++){if(!isFreqDfs(regdomain,ieee_mode,chanbw,b[d])){a.push(b[d])}}$("#polling_airselect_channels").val(a)}}}function getDfsStatus(){var a=!(rg_data.has_dfs&&!requiresCE(country)&&country!=756&&country!=840&&country!=124&&country!=630&&country!=764);var b=$("#dfs").is(":checked");return(a||b)}function openScanChannelSelectWrls(){var c=$("#wmode").val();if((c!="sta")&&(devdomain=="5000")){var b=getDfsStatus();var a=polling_fh&&polling&&b}else{var a=false}openScanChannelSelect("scan_channels",$("#hideindoor_chk").is(":checked"),a||unii_on)}function openScanChannelSelectUbnt(d,b,c,a){if(a!="5000"){c=false}openScanChannelSelect(d,b,c||unii_on)}function openScanChannelSelect(e,c,b){var a="scan_channels.cgi";a+="?ieee_mode="+ieee_mode;a+="&country="+country;a+="&chanbw="+globals.chanbw;a+="&airmax="+airmax;a+="&obey="+obey;a+="&elemId="+e;var d=document.getElementById(e);a+="&isIndoorHidden="+c;a+="&hide_dfs="+b;a+="&scan_channels="+$("#"+e).val();return openPage(a,700)}function setScanChannels(b,a){$("#"+b).val(a)}function checkScanListPower(f,a,e,c){var d=0;for(var b=0;b<a.length;b++){for(var g in e){for(channel in e[g][c]){if(channel==a[b]){if(!d){d=e[g][c][channel][1]}else{if((e[g][c][channel][1]>d)&&(f.toUpperCase().search("MIN"))){d=e[g][c][channel][1]}else{if((e[g][c][channel][1]<d)&&(f.toUpperCase().search("MAX"))){d=e[g][c][channel][1]}}}break}}}}return d}function get_current_scan_channels(d){var c=/^[0-9, ]*$/;var b=/ /g;if(d==null||d.length==0||c.exec(d)==null){return[]}var a=d.replace(b,"");return a.split(",")}function validateFrequency(){if(!$("#channel_scan_list").is(":checked")){return true}var b=$("#chan_freq").val();var c=(b==0);if(!c){var a=get_current_scan_channels($("#scan_channels").val());for(i=0;!c&&i<a.length;++i){c=(a[i]==b)}}if(!c){setError(jsTranslate('err_invalid_freq|Invalid frequency selected - must be one from the Frequency List or "Auto."'))}return c}function validateFreqListStatus(){if(polling&&polling_fh&&!$("#channel_scan_list").is(":checked")){setError(jsTranslate('err_freq_list_status|Frequency List cannot be disabled while <a href="ubnt.cgi">airSelect</a> is turned on.'));return false}return true}function checkSecurity(a){var e=$("#security").val().toUpperCase();var d=$("#wmode").val();var c=["wep","wpa","wpa2","wpatkip","wpa2tkip"];if(d=="aprepeater"){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(f){return jQuery.inArray(f,this)}}var b=c.indexOf("wep");if(b>-1){c.splice(b,1)}}for(i=0;i<c.length;i++){if(e!=c[i].toUpperCase()){$("#security option[value="+c[i]+"]").remove()}}}function updateFreqList(){var c=$("#chan_freq option").map(function(e,f){return $(f).val()}).get();var a=get_current_scan_channels($("#scan_channels").val());var d=[];for(var b=0;b<a.length;++b){if($.inArray(a[b],c)!=-1){d[d.length]=a[b]}}if(a.length!=d.length){$("#scan_channels").val(d.join(","))}if($("#scan_channels").val()==""){$("#channel_scan_list").attr("checked",false);$("#scan_channels").toggle(false);$("#edit_scan_channels").toggle(false)}}function isFreqIndoor(b){var a=parseInt(b);if((a>=5180&&a<=5320)&&country!=511){return true}else{return false}}function isFreqDfs(c,d,b,e){var f=getRegdomainMode(d);var a=c[f][b];if((a[e][5]==1)&&(country!=511)){return true}else{return false}}function isFreqFccUnii1(b){var a=parseInt(b);if(a>=5160&&a<=5245){return true}else{return false}}function sort_antennas(){$("#antenna_info").html($("#antenna_info option").sort(function(f,d){var e=parseInt(parseInt(f.value.split("|")[1]));var g=parseInt(parseInt(d.value.split("|")[1]));var c=f.text.toUpperCase();var h=d.text.toUpperCase();if(e>g){return 1}else{if(e<g){return -1}else{if(e==g){if(c>h){return -1}else{if(c<h){return 1}else{return 0}}}else{return 0}}}}))};