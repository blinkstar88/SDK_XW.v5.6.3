--- a/src/forward.c
+++ b/src/forward.c
@@ -705,14 +705,18 @@ void receive_query(struct listener *list
   if ((n = recvmsg(listen->fd, &msg, 0)) == -1)
     return;
   
   if (n < (int)sizeof(struct dns_header) || 
       (msg.msg_flags & MSG_TRUNC) ||
       (header->hb3 & HB3_QR))
     return;
+
+  /* Clear buffer beyond request to avoid risk of
+     information disclosure. */
+  memset(daemon->packet + n, 0, daemon->edns_pktsz - n);
   
   source_addr.sa.sa_family = listen->family;
 #ifdef HAVE_IPV6
   if (listen->family == AF_INET6)
     source_addr.in6.sin6_flowinfo = 0;
 #endif
 
@@ -897,14 +901,18 @@ unsigned char *tcp_request(int confd, ti
 	  !read_write(confd, &c1, 1, 1) || !read_write(confd, &c2, 1, 1) ||
 	  !(size = c1 << 8 | c2) ||
 	  !read_write(confd, packet, size, 1))
        	return packet; 
   
       if (size < (int)sizeof(struct dns_header))
 	continue;
+
+      /* Clear buffer beyond request to avoid risk of
+	 information disclosure. */
+      memset(packet + size, 0, 65536 - size);
       
       header = (struct dns_header *)packet;
 
       /* save state of "cd" flag in query */
       checking_disabled = header->hb4 & HB4_CD;
        
       /* RFC 4035: sect 4.6 para 2 */
